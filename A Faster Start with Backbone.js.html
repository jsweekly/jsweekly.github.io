<div style="max-width: 700px;font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;padding: 50px;line-height: 1.25;"><meta charset="UTF8"/><title>A Faster Start with Backbone.js</title><h1>A Faster Start with Backbone.js</h1><p><a href="http://thinkingonthinking.com/fast-start-with-backbonejs/?">Original Article</a> &middot; <a href="#articleList">Articles in this issue</a> </p><div><div class="ten columns" id="article-content">
    <p>There is a saying by <a href="http://en.wikipedia.org/wiki/Samuel_Goldwyn">Sam Goldwyn</a>: </p>

<pre><code>"Don't pay any attention to the critics. Don't even ignore them."
</code></pre>

<p>And some of the critical voices on the <a href="http://pipefishbook.com">Pipefishbook</a> say, that the book focusses too much on JavaScript tools instead of discussing Backbone.</p>

<p>It is true: <a href="http://backbonejs.org">Backbone.js</a> is a frontend library. Frontend means HTML. Frontend often means <a href="http://jquery.org">JQuery</a> too. And indeed, intoducing Backbone is very well possible without mentioning modules or dependency managers in the first place.</p>

<p>So, let&#x2019;s start with seeds for a browser drawing app with Backbone.js, hmm&#x2026; better: <a href="http://backbonesvg.divshot.io/">An SVG rectangle coloring app</a> since it will be enough to show what Backbone is about.</p>

<p><img src="http://thinkingonthinking.com/static/images/drawing_app.png"></p>

<h2 id="the-indexhtml">The index.html</h2>

<p>To start with browser interactions, you need some basic HTML. A simple HTML &#x201C;gestalt&#x201D; may look like:</p>

<pre><code>&lt;html&gt;
  &lt;head&gt;
  &lt;/head&gt;
  &lt;body&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Once a basic HTML is setup, you must include JavaScript libs, i.e. Backbone and its dependencies <a href="http://underscorejs.org">Underscore</a> and jQuery&#x2026; If you have a network connection, the simplest way is including some references to CDNs entries:</p>

<pre><code>  &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.js"&gt;
  &lt;/script&gt;
  &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"&gt;
  &lt;/script&gt;
  &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.0/backbone-min.js"&gt;
</code></pre>

<p>Those libs are rather small and may be included in the HTML header above. Note: JavaScript modules and dependeny managers can help you bundling external dependencies and improve app performance. But this blog post is not yet the place to discuss this.</p>

<p>First breath out. We are now set to actually build a Backbone app!</p>

<h2 id="building-the-data-layer">Building the Data layer</h2>

<p>The next design step is about adding dummy data for a drawing. This may conflict with your instinct of adding SVG shapes directly. But separting a UI from &#x201C;business logic&#x201D; will save you some headaches in the long run.</p>

<p>So, here is the data:</p>

<pre><code>var drawing = [
  {id: 1, x1: 20, y1: 20, x2: 100, y2: 100, color: '#ff0000'}, 
  {id: 2, x1: 420, y1: 220, x2: 500, y2: 400, color: '#00ff00'}
];
</code></pre>

<p>By starting with data first has the advantage that you get a feeling for the abstractions you are working with. You don&#x2019;t build a car from the outside in, but from the inside out based on an engine. Similarly, the data is the engine of your UI.</p>

<p>If you are still thinking DOM nodes are your thing, no worries.  We come to that in a second.</p>

<p>First, let&#x2019;s wrap the raw drawing data in a Backbone <a href="http://backbonejs.org/#Collection">collection</a> and <a href="http://backbonejs.org/#Model">models</a>. With the Backbone API&#x2019;s for data, it is easy to change and observe data changes.</p>

<p>For the coloring app, the basic setup for Backbone models and collection is the following:</p>

<pre><code>var Rectangle = Backbone.Model.extend({});
  
var Rectangles = Backbone.Collection.extend({
  model: Rectangle
});
</code></pre>

<p>In your JavaScript, you can now work with instances of rectangles as follows:</p>

<pre><code>var rectangles = new Rectangles(drawing);
</code></pre>

<p>In principle, you could now change properties of the rectangles. You also could sort and filter the rectangles with native Backbone commands. For this, you can consult a book (ideally, the Pipefishbook). </p>

<h2 id="rendering-the-ui">Rendering the UI</h2>

<p>The fun of UI&#x2019;s is in rendering. And, in capturing events from users. This is where the other half of Backbone.js comes in. For example, rendering rectangles could be done with Backbone.View as follows:</p>

<pre><code>   // the scene class extends a Backbone view
   var Scene  = Backbone.View.extend({

     // renders an SVG rectangle from a shapes collection
     render: function() {
       var el = this.$el;
       el.empty();
       this.collection.each(function(model) {
         var rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
         rect.setAttribute('x', model.get('x1'));
         rect.setAttribute('y', model.get('y1'));
         rect.setAttribute('width',  model.get('x2') - model.get('x1'));
         rect.setAttribute('height', model.get('y2') - model.get('y1'));
         rect.setAttribute('style', 'fill:' + model.get('color') + ';stroke:pink');
         rect.id = model.get('id');
         el.append(rect);
       });
       return el;
     }

   })
</code></pre>

<p>Within the render function, you normally would call a template function. For learning, constructing a DOM node &#x201C;manually&#x201D; just works fine.</p>

<p>Note, rendering happens in a context, often directly after the page load event:</p>

<pre><code>  var scene;
  $(document).ready(function() {
    scene = new Scene({el: $('svg'), collection: rectangles });
  });
</code></pre>

<h2 id="capturing-user-events">Capturing user events</h2>

<p>Next, and last, you want to offer some way to have user influence the rendered objects. For this, let&#x2019;s hook into the mouse events of a user. A Backbone.View provides a property &#x201C;events&#x201D; for this.</p>

<p>Working with events can quickly become complicated. To kepp it simple, let&#x2019;s show an approach to handle click events. This gives:</p>

<pre><code>   var Scene  = Backbone.View.extend({

     events: {
       'click rect': 'handleClick'
     },

     handleClick: function(ev) {
       var id = $(ev.currentTarget).attr('id');
       var rect = this.collection.get(id);
       rect.set('color', getRandomColor());
     },

     // ...
   
     // binding events to data changes is important too:
    initialize: function() {
      this.listenTo(this.collection, 'change:color', this.render);
    }

  });
</code></pre>

<p>You see, the app size slowly increases. There is even new function getRandomColor(). But the main point right now: We capture events from users, and bind a view provides to change events in the data layer. The view re-renders as needed.</p>

<h2 id="going-further">Going further</h2>

<p>Because we have the conceptual model of the UI in Backbone collections and models, you can set the color from the browsers from other sources, than from user events, remote or from development console for example. Try the development console, open it, and try:</p>

<pre><code>&gt; rectangles
&gt; r = rectangles.get(1)
&gt; r.set('color', 'black')
</code></pre>

<p>Now, the color of the rectangles changes. Well, a &#x201C;real&#x201D; drawing app takes much more work. And you will be faced to re-use ideas and code for drawing circles or lines. Even, the simple function getRandomColor() is just copy and pasted from <a href="http://stackoverflow.com/questions/1484506/random-color-generator-in-javascript">here</a>. Ideally, you could make code re-use easier. It is here where JavaScript module formats come in, such as CommonJS or RequireJS. Consult the <a href="http://pipefishbook.com">Pipefishbook</a> for more info&#x2019;s or leave me feedback. Thanks for reading!</p>

<p>Checkout the <a href="http://backbonesvg.divshot.io/">demo</a>.  Or the small <a href="https://github.com/pipefishbook/rectangle_coloring">repo</a>.</p>

  </div>

  </div><hr/><section id="articleList" style="font-size: 14px;"><b>Articles in This Issue</b><ul><li><a href="./Understanding ECMAScript 6.html">Understanding ECMAScript 6</a></li><li><a href="./Getting Started with React and JSX.html">Getting Started with React and JSX</a></li><li><a href="./Regulex：A JavaScript Regular Expression Visualizer.html">Regulex：A JavaScript Regular Expression Visualizer</a></li><li><a href="./What's in a Function Name?.html">What's in a Function Name?</a></li><li><a href="./The Difference Between Java and JavaScript (in comic book form).html">The Difference Between Java and JavaScript (in comic book form)</a></li><li><a href="./PowerArray: The JavaScript Array with Boosted Performance.html">PowerArray: The JavaScript Array with Boosted Performance</a></li><li><a href="./Frontend Javascript-Angular developer at Contentful (Berlin, Germany).html">Frontend Javascript/Angular developer at Contentful (Berlin, Germany)</a></li><li><a href="./JavaScript Devs in High Demand (SF, LA, NY, ORD, BOS).html">JavaScript Devs in High Demand (SF, LA, NY, ORD, BOS)</a></li><li><a href="./Yahoo Mail Moving to Node and React + Flux (slide-deck).html">Yahoo Mail Moving to Node and React + Flux (slide-deck)</a></li><li><a href="./ShirtJS: JavaScript Framework Themed Clothing.html">ShirtJS: JavaScript Framework Themed Clothing</a></li><li><a href="./This Dashcam Simulation Is Just 1K Of JavaScript Magic.html">This Dashcam Simulation Is Just 1K Of JavaScript Magic</a></li><li><a href="./A Beginner's Guide to Grunt: Redux.html">A Beginner's Guide to Grunt: Redux</a></li><li><a href="./An Overview of Functional Techniques (for non FPers) using JavaScript.html">An Overview of Functional Techniques (for non FPers) using JavaScript</a></li><li><a href="./A Faster Start with Backbone.js.html">A Faster Start with Backbone.js</a></li><li><a href="./Tracking Pageviews with Google Analytics and Angular.html">Tracking Pageviews with Google Analytics and Angular</a></li><li><a href="./Understanding JavaScript Generators.html">Understanding JavaScript Generators</a></li><li><a href="./Ten Talks from NodeConf One-Shot Budapest.html">Ten Talks from NodeConf One-Shot Budapest</a></li><li><a href="./Build Production Ready JavaScript Apps With Grunt.html">Build Production Ready JavaScript Apps With Grunt</a></li><li><a href="./Adopting AngularJS for Enterprise Software.html">Adopting AngularJS for Enterprise Software</a></li><li><a href="./The Road to Ember 2.0 with Tom Dale and Yehuda Katz.html">The Road to Ember 2.0 with Tom Dale and Yehuda Katz</a></li><li><a href="./Resources for JavaScript and DOM Compatibility Tables.html">Resources for JavaScript and DOM Compatibility Tables</a></li><li><a href="./Node.js Tools for Visual Studio 1.0 Release Candidate.html">Node.js Tools for Visual Studio 1.0 Release Candidate</a></li><li><a href="./Handsontable: JavaScript Excel-like Data Grid Editor.html">Handsontable: JavaScript Excel-like Data Grid Editor</a></li><li><a href="./SVG Morpheus: JS Library for Morphing Between SVG Icons.html">SVG Morpheus: JS Library for Morphing Between SVG Icons</a></li><li><a href="./Tubemaps: Browser and Node Library and Command-Line Tool for Handling (London) Tube Data.html">Tubemaps: Browser and Node Library and Command-Line Tool for Handling (London) Tube Data</a></li><li><a href="./SmartUnderline: Better Looking Underlines on the Web.html">SmartUnderline: Better Looking Underlines on the Web</a></li><li><a href="./QuaggaJS: An Advanced Barcode-Reader Written in JavaScript.html">QuaggaJS: An Advanced Barcode-Reader Written in JavaScript</a></li><li><a href="./Jss: Dynamic Stylesheets for Web Components.html">Jss: Dynamic Stylesheets for Web Components</a></li></ul></section></div>